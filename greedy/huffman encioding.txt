#include <bits/stdc++.h>
using namespace std;

struct Node{
    char data;
    int freq;
    Node* left;
    Node* right;
};
vector<char> c1;
void printCodes(Node* root, string str) 
{ 
  
    if (!root) 
        return; 
  
    if (root->data != '&') 
        cout << str <<' '; 
  
    printCodes(root->left, str + "0"); 
    printCodes(root->right, str + "1"); 
}
struct myCom{
    bool operator()(Node* a,Node* b){
        return (a->freq>b->freq);
    }
};
int main() {
	int t;
	cin>>t;
	while(t--){
	    string s;
	    cin>>s;
	    int n = s.length();
	    std::priority_queue<Node*, std::vector<Node*>, myCom> pq;
	    for(int i=0;i<n;i++){
	        int f;
	        cin>>f;
	        Node* t = (Node*) malloc(sizeof(Node));
	        t->left = NULL;
	        t->right = NULL;
	        t->freq = f;
	        t->data = s[i];
	        pq.push(t);
	    }
	    while(pq.size()>1){
	        Node* l = pq.top();
	        pq.pop();
	        Node* r = pq.top();
	        pq.pop();
	        Node* t = (Node*) malloc(sizeof(Node));
	        t->left = l;
	        t->right = r;
	        t->data = '&';
	        t->freq = l->freq + r->freq;
	        pq.push(t);
	    }
	    Node* root = pq.top();
	    pq.pop();
	    printCodes(root, "");
	    cout<<endl;
	}
	return 0;
}